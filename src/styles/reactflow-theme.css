/* React Flow Dark Theme Overrides */

/* Dark mode styling for React Flow */
.react-flow__renderer {
  background-color: var(--background);
}

.react-flow__background {
  background-color: var(--background);
}

.dark .react-flow__renderer {
  background-color: var(--background);
}

.dark .react-flow__background {
  background-color: var(--background);
}

/* Background pattern visibility */
.react-flow__background-pattern {
  stroke: var(--foreground);
}

.dark .react-flow__background-pattern {
  stroke: var(--foreground);
}

/* Edge styling - ensure edges are visible and easily selectable */
.react-flow__edge-path {
  stroke-width: 3px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.dark .react-flow__edge-path {
  stroke: var(--foreground) / 0.5;
  stroke-width: 3px;
}

/* Make edges easier to hover/select with wider interaction area */
.react-flow__edge {
  pointer-events: all;
}

.react-flow__edge-interaction {
  stroke: transparent;
  stroke-width: 30px;
  fill: none;
  cursor: pointer;
}

/* Hover effect for edges - make them MUCH more visible */
.react-flow__edge:hover .react-flow__edge-path {
  opacity: 1;
  stroke-width: 5px !important;
  filter: drop-shadow(0 0 8px currentColor) brightness(1.3);
  transition: all 0.2s ease;
}

/* Selected edge styling */
.react-flow__edge.selected .react-flow__edge-path {
  stroke-width: 5px !important;
  filter: drop-shadow(0 0 10px currentColor) brightness(1.5);
  animation: pulse-edge 2s ease-in-out infinite;
}

@keyframes pulse-edge {
  0%,
  100% {
    filter: drop-shadow(0 0 8px currentColor) brightness(1.5);
  }
  50% {
    filter: drop-shadow(0 0 12px currentColor) brightness(1.8);
  }
}

.react-flow__edge-text {
  fill: var(--foreground);
}

.dark .react-flow__edge-text {
  fill: var(--foreground);
}

.react-flow__edge-textbg {
  fill: var(--background);
}

.dark .react-flow__edge-textbg {
  fill: var(--background);
}

/* Markers */
.react-flow__arrowhead {
  fill: currentColor;
}

.react-flow__marker {
  overflow: visible;
}

/* Controls styling */
.dark .react-flow__controls {
  background-color: var(--card);
  border: 1px solid var(--border);
  box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.3);
}

.dark .react-flow__controls-button {
  background-color: var(--card);
  border-bottom: 1px solid var(--border);
  color: var(--foreground);
}

.dark .react-flow__controls-button:hover {
  background-color: var(--accent);
}

.dark .react-flow__controls-button svg {
  fill: var(--foreground);
}

/* Minimap styling */
.dark .react-flow__minimap {
  background-color: var(--card);
  border: 1px solid var(--border);
  box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.3);
}

.dark .react-flow__minimap-mask {
  fill: rgb(0 0 0 / 0.3);
}

/* Attribution */
.dark .react-flow__attribution {
  background-color: var(--card) / 0.8;
  color: var(--muted-foreground);
  border: 1px solid var(--border);
}

/* Panel styling */
.dark .react-flow__panel {
  color: var(--foreground);
}

/* Selection box */
.dark .react-flow__selection {
  background-color: var(--primary) / 0.1;
  border: 1px solid var(--primary);
}

/* Node selection */
.dark .react-flow__node.selected {
  box-shadow: 0 0 0 2px var(--primary);
}

/* Edge selection */
.dark .react-flow__edge.selected .react-flow__edge-path {
  stroke: var(--primary);
  stroke-width: 2.5px;
}

/* Handle styling */
.dark .react-flow__handle {
  background-color: var(--primary);
  border: 2px solid var(--background);
}

.dark .react-flow__handle:hover {
  background-color: var(--primary) / 0.8;
}

/* Connection line */
.dark .react-flow__connectionline {
  stroke: var(--primary);
}

/* Nodes drag */
.dark .react-flow__nodesselection-rect {
  background-color: var(--primary) / 0.1;
  border: 1px solid var(--primary);
}

/* Ensure panels don't interfere with nodes */
.react-flow__panel {
  pointer-events: none;
  z-index: 5;
}

.react-flow__panel > * {
  pointer-events: auto;
}

/* Fix panel positioning so they don't overlap nodes */
.react-flow__panel.react-flow__panel-top {
  top: 10px;
}

.react-flow__panel.react-flow__panel-bottom {
  bottom: 10px;
}

.react-flow__panel.react-flow__panel-left {
  left: 10px;
}

.react-flow__panel.react-flow__panel-right {
  right: 10px;
}

/* Connection Animation Styles */
@keyframes flow-animation {
  0% {
    stroke-dashoffset: 24;
  }
  100% {
    stroke-dashoffset: 0;
  }
}

@keyframes pulse-animation {
  0%,
  100% {
    opacity: 1;
    filter: brightness(1);
  }
  50% {
    opacity: 0.7;
    filter: brightness(1.3);
  }
}

/* Animated edges */
.react-flow__edge-path[data-animated="true"] {
  stroke-dasharray: 8, 4;
  animation: flow-animation 2s linear infinite;
}

.react-flow__edge-path[data-animation-type="pulse"] {
  animation: pulse-animation 2s ease-in-out infinite;
}

.react-flow__edge-path[data-animation-type="dash"] {
  stroke-dasharray: 5, 5;
  animation: flow-animation 2s linear infinite;
}
